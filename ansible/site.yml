- name: Provision Complete Stack
  hosts: all
  become: yes
  
  tasks:
    - import_tasks: tasks/01-warmup.yml
    - import_tasks: tasks/02-podman.yml
    - import_tasks: tasks/03-security.yml
    - import_tasks: tasks/04-nginx.yml

    - name: Reboot and Verify SSH on Custom port
      block:
        - name: Reboot the hosts
          reboot:
            reboot_timeout: 10
          ignore_errors: yes

        - name: Pause for reboot to take effect
          pause:
            seconds: 30
